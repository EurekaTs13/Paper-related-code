import pandas as pd

# Define file paths and similarity matrix
topic_martix_path = r"D:\excel\finance\topic_60_0.8_100_iter=5.xlsx"
output_excel_path = r"D:\excel\内生性问题修正矩阵.xlsx"
topic_similarity_martix = [[1.0, 0.4426, 0.4735, 0.5048, 0.4098, 0.4365, 0.399, 0.4466, 0.4813, 0.5249, 0.4101, 0.4744, 0.4829, 0.4748, 0.4123, 0.4553, 0.4571, 0.5101, 0.4418, 0.452, 0.4562, 0.5638, 0.3578, 0.4616, 0.4199, 0.4337, 0.4751, 0.4079, 0.4316, 0.5598, 0.4358, 0.347, 0.4244, 0.4426, 0.4691, 0.5396, 0.4132, 0.4578, 0.5224, 0.4856, 0.3799, 0.3539, 0.3929, 0.5167, 0.4175, 0.4486, 0.4324, 0.4463, 0.5664, 0.4192, 0.5977, 0.4856, 0.4919, 0.4179, 0.4223, 0.4324, 0.4319, 0.4133, 0.4144, 0.401], [0, 1.0, 0.4705, 0.5509, 0.578, 0.3368, 0.6938, 0.4718, 0.5966, 0.3935, 0.4448, 0.4112, 0.3298, 0.704, 0.3039, 0.8726, 0.7812, 0.5501, 0.6461, 0.8504, 0.6124, 0.5086, 0.3667, 0.3461, 0.4113, 0.4189, 0.479, 0.5903, 0.5464, 0.5016, 0.7002, 0.4222, 0.5032, 0.5215, 0.706, 0.5605, 0.7915, 0.5289, 0.2999, 0.5943, 0.5338, 0.7508, 0.4546, 0.4589, 0.4876, 0.3623, 0.7473, 0.6335, 0.4995, 0.3499, 0.4222, 0.4622, 0.4925, 0.6825, 0.784, 0.5847, 0.6276, 0.4363, 0.4641, 0.5997], [0, 0, 1.0, 0.5996, 0.6226, 0.4041, 0.5312, 0.6035, 0.5667, 0.513, 0.505, 0.429, 0.4407, 0.6354, 0.4819, 0.5372, 0.5789, 0.5704, 0.5612, 0.5316, 0.6235, 0.5454, 0.4618, 0.5521, 0.5331, 0.6024, 0.6318, 0.5527, 0.5608, 0.6144, 0.5655, 0.5569, 0.5058, 0.6232, 0.5151, 0.6883, 0.5541, 0.5883, 0.4253, 0.6041, 0.5085, 0.4393, 0.6219, 0.5271, 0.6078, 0.3782, 0.552, 0.5353, 0.5788, 0.4965, 0.4495, 0.5379, 0.5675, 0.5938, 0.5416, 0.4968, 0.5481, 0.5342, 0.6163, 0.4899], [0, 0, 0, 1.0, 0.623, 0.4474, 0.6569, 0.6411, 0.483, 0.3499, 0.4517, 0.4314, 0.3591, 0.724, 0.4816, 0.5182, 0.6625, 0.5177, 0.5928, 0.5215, 0.6251, 0.5928, 0.4213, 0.5564, 0.5641, 0.5838, 0.6176, 0.612, 0.5873, 0.5479, 0.69, 0.4896, 0.4989, 0.5557, 0.5297, 0.6668, 0.6719, 0.4933, 0.3931, 0.5353, 0.5396, 0.4706, 0.6177, 0.4115, 0.6125, 0.3077, 0.5717, 0.5005, 0.5588, 0.394, 0.4342, 0.5005, 0.5065, 0.6111, 0.4985, 0.5736, 0.4788, 0.5085, 0.595, 0.5489], [0, 0, 0, 0, 1.0, 0.3549, 0.6993, 0.5433, 0.5565, 0.3866, 0.5093, 0.3954, 0.3957, 0.7427, 0.3639, 0.5998, 0.6364, 0.4922, 0.7163, 0.6147, 0.69, 0.4844, 0.425, 0.3801, 0.5184, 0.6709, 0.7185, 0.6628, 0.6695, 0.5535, 0.665, 0.5597, 0.5956, 0.5231, 0.557, 0.6926, 0.6972, 0.6008, 0.2849, 0.5329, 0.5966, 0.5862, 0.715, 0.4737, 0.5725, 0.3347, 0.5897, 0.6089, 0.5762, 0.3594, 0.4027, 0.4518, 0.5406, 0.6416, 0.5955, 0.6129, 0.5931, 0.5675, 0.5562, 0.588], [0, 0, 0, 0, 0, 1.0, 0.342, 0.4697, 0.4947, 0.3136, 0.3669, 0.3678, 0.4434, 0.4057, 0.4627, 0.3591, 0.4017, 0.4456, 0.4666, 0.3489, 0.3618, 0.3822, 0.7055, 0.6024, 0.3989, 0.4231, 0.3765, 0.3688, 0.4094, 0.4381, 0.4256, 0.6175, 0.4184, 0.4635, 0.3958, 0.4429, 0.3715, 0.3698, 0.502, 0.4264, 0.3731, 0.3059, 0.3978, 0.344, 0.592, 0.4373, 0.4377, 0.3665, 0.3922, 0.4128, 0.4306, 0.4528, 0.3714, 0.4312, 0.3813, 0.3525, 0.3792, 0.4676, 0.4884, 0.4458], [0, 0, 0, 0, 0, 0, 1.0, 0.5634, 0.5462, 0.3224, 0.4784, 0.3982, 0.3651, 0.87, 0.3984, 0.6515, 0.645, 0.4693, 0.6011, 0.6978, 0.7159, 0.4826, 0.3785, 0.4516, 0.5784, 0.4992, 0.6664, 0.7152, 0.5983, 0.5017, 0.6751, 0.4665, 0.546, 0.5472, 0.6822, 0.6842, 0.7849, 0.5635, 0.3481, 0.5904, 0.5462, 0.7432, 0.5537, 0.3923, 0.4742, 0.3276, 0.5874, 0.6389, 0.5824, 0.3551, 0.3657, 0.4686, 0.525, 0.6072, 0.6453, 0.6387, 0.5796, 0.4895, 0.5831, 0.5224], [0, 0, 0, 0, 0, 0, 0, 1.0, 0.5316, 0.406, 0.4848, 0.4301, 0.4307, 0.6658, 0.6696, 0.4618, 0.5125, 0.5478, 0.5598, 0.4981, 0.5288, 0.5077, 0.4627, 0.7308, 0.5964, 0.5478, 0.5787, 0.6154, 0.5532, 0.6144, 0.6019, 0.554, 0.5445, 0.6377, 0.5577, 0.6511, 0.5546, 0.5088, 0.5187, 0.5475, 0.5172, 0.4605, 0.5527, 0.4531, 0.6489, 0.3489, 0.5675, 0.5311, 0.561, 0.6002, 0.4859, 0.621, 0.629, 0.6613, 0.4957, 0.5039, 0.4947, 0.6387, 0.6446, 0.5329], [0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.5282, 0.503, 0.4456, 0.4872, 0.5799, 0.4247, 0.642, 0.5875, 0.574, 0.5632, 0.6889, 0.5447, 0.4415, 0.5409, 0.435, 0.4635, 0.5417, 0.5315, 0.5677, 0.4704, 0.5309, 0.5993, 0.5917, 0.6228, 0.5233, 0.6222, 0.6078, 0.6105, 0.6171, 0.413, 0.5951, 0.4594, 0.5725, 0.5571, 0.5486, 0.5458, 0.4498, 0.6106, 0.5879, 0.516, 0.4365, 0.47, 0.5264, 0.563, 0.5863, 0.6989, 0.4887, 0.6841, 0.5561, 0.5432, 0.5289], [0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.3862, 0.4548, 0.3695, 0.401, 0.2776, 0.4216, 0.3928, 0.5019, 0.4015, 0.4623, 0.4132, 0.3842, 0.3469, 0.2957, 0.3618, 0.3119, 0.4304, 0.302, 0.3483, 0.4802, 0.3896, 0.3358, 0.4402, 0.3778, 0.3532, 0.425, 0.3074, 0.4363, 0.3176, 0.4243, 0.3516, 0.2972, 0.3435, 0.7014, 0.3608, 0.4641, 0.3933, 0.419, 0.414, 0.3807, 0.4032, 0.4705, 0.4622, 0.3371, 0.4772, 0.3487, 0.5232, 0.3369, 0.4652, 0.3551], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.5263, 0.7346, 0.5166, 0.4379, 0.4879, 0.4985, 0.4771, 0.4982, 0.5169, 0.59, 0.4483, 0.4781, 0.3888, 0.4028, 0.5381, 0.582, 0.4775, 0.4518, 0.5043, 0.5105, 0.4718, 0.7453, 0.4938, 0.499, 0.6343, 0.4671, 0.4359, 0.4024, 0.6435, 0.4185, 0.4705, 0.5019, 0.4923, 0.4638, 0.4996, 0.4064, 0.6843, 0.5049, 0.4187, 0.3528, 0.4814, 0.6413, 0.4024, 0.4686, 0.3923, 0.6321, 0.4758, 0.4685, 0.4696], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.5519, 0.4413, 0.568, 0.3856, 0.3931, 0.43, 0.4194, 0.3921, 0.4234, 0.3803, 0.3169, 0.4253, 0.3457, 0.4219, 0.3956, 0.3143, 0.4249, 0.4691, 0.5264, 0.397, 0.5602, 0.4628, 0.387, 0.4745, 0.3971, 0.4237, 0.538, 0.4573, 0.4082, 0.3412, 0.4086, 0.4354, 0.4028, 0.5189, 0.3843, 0.4587, 0.432, 0.4621, 0.2985, 0.4322, 0.4329, 0.374, 0.4383, 0.3882, 0.4417, 0.3832, 0.5802, 0.4546], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.3994, 0.5331, 0.3675, 0.3637, 0.4445, 0.3455, 0.3694, 0.4177, 0.3761, 0.4016, 0.4335, 0.3288, 0.4891, 0.4668, 0.3495, 0.428, 0.4429, 0.426, 0.4263, 0.6365, 0.4678, 0.4175, 0.5323, 0.3585, 0.3974, 0.4675, 0.4833, 0.3205, 0.3752, 0.3887, 0.4183, 0.3915, 0.6258, 0.3907, 0.5343, 0.4201, 0.4292, 0.3985, 0.4633, 0.5437, 0.3345, 0.4059, 0.3477, 0.4646, 0.475, 0.5222, 0.3916], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.4556, 0.689, 0.7142, 0.5592, 0.6611, 0.7171, 0.7158, 0.5358, 0.453, 0.5226, 0.5987, 0.567, 0.6953, 0.7065, 0.6629, 0.5849, 0.7473, 0.5239, 0.5717, 0.649, 0.7314, 0.7667, 0.8066, 0.6118, 0.4107, 0.6234, 0.6332, 0.7505, 0.6405, 0.4763, 0.5603, 0.351, 0.6902, 0.6819, 0.6199, 0.4298, 0.4316, 0.5562, 0.612, 0.7107, 0.695, 0.6623, 0.6066, 0.5632, 0.637, 0.6089], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.2934, 0.3279, 0.4301, 0.3713, 0.3109, 0.3834, 0.3057, 0.3186, 0.7913, 0.3572, 0.551, 0.4471, 0.4046, 0.4275, 0.4229, 0.4781, 0.4782, 0.5279, 0.5416, 0.4253, 0.5355, 0.3807, 0.4274, 0.6393, 0.4296, 0.3417, 0.326, 0.4549, 0.3187, 0.4807, 0.3986, 0.3941, 0.4049, 0.4727, 0.5343, 0.3121, 0.5267, 0.5239, 0.4109, 0.3539, 0.37, 0.3473, 0.572, 0.7005, 0.4213], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.8138, 0.5865, 0.6731, 0.9088, 0.6248, 0.5116, 0.4361, 0.3461, 0.4079, 0.4836, 0.5021, 0.601, 0.5765, 0.5546, 0.6979, 0.502, 0.5712, 0.5666, 0.7555, 0.593, 0.7711, 0.5803, 0.2883, 0.5864, 0.5773, 0.7734, 0.5072, 0.4604, 0.5139, 0.3936, 0.819, 0.6539, 0.5038, 0.3613, 0.4266, 0.429, 0.5249, 0.7223, 0.8556, 0.5799, 0.6781, 0.4996, 0.4783, 0.6381], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.5998, 0.7422, 0.7786, 0.6304, 0.5776, 0.4664, 0.3762, 0.442, 0.5267, 0.5181, 0.5824, 0.5784, 0.5623, 0.7483, 0.5233, 0.5175, 0.5418, 0.6193, 0.6086, 0.7493, 0.5457, 0.2879, 0.5362, 0.64, 0.6335, 0.614, 0.4815, 0.5746, 0.3409, 0.7802, 0.5903, 0.5367, 0.3582, 0.4373, 0.4248, 0.502, 0.7226, 0.7297, 0.548, 0.5709, 0.4877, 0.4704, 0.7213], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.5476, 0.5857, 0.5419, 0.478, 0.4603, 0.4972, 0.4874, 0.5246, 0.5578, 0.46, 0.4784, 0.5966, 0.5353, 0.4745, 0.528, 0.502, 0.6455, 0.5856, 0.5208, 0.5341, 0.4355, 0.5537, 0.4829, 0.4773, 0.4836, 0.487, 0.5596, 0.4847, 0.5222, 0.5426, 0.5609, 0.4997, 0.4877, 0.5036, 0.5952, 0.52, 0.5913, 0.3709, 0.5592, 0.4569, 0.5229, 0.5938], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.6574, 0.627, 0.5323, 0.5574, 0.4131, 0.4596, 0.5455, 0.5414, 0.6585, 0.5917, 0.6158, 0.7079, 0.6181, 0.5147, 0.5028, 0.5961, 0.5867, 0.6816, 0.5637, 0.3413, 0.604, 0.7036, 0.5983, 0.5895, 0.454, 0.673, 0.295, 0.6448, 0.5962, 0.4939, 0.3913, 0.4406, 0.4579, 0.5134, 0.6712, 0.6165, 0.6022, 0.5687, 0.518, 0.4591, 0.7621], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.6156, 0.5412, 0.4379, 0.3842, 0.4523, 0.4709, 0.5787, 0.6279, 0.5631, 0.5982, 0.6866, 0.4521, 0.6089, 0.5845, 0.7851, 0.6422, 0.8001, 0.5354, 0.3098, 0.6166, 0.5756, 0.8143, 0.4964, 0.5401, 0.521, 0.3916, 0.7471, 0.7441, 0.5521, 0.4023, 0.4561, 0.5511, 0.6142, 0.682, 0.8533, 0.604, 0.7631, 0.5032, 0.5102, 0.6211], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.5824, 0.4086, 0.4634, 0.6033, 0.5794, 0.7206, 0.5823, 0.5489, 0.5685, 0.6453, 0.491, 0.5767, 0.5172, 0.5904, 0.7146, 0.6464, 0.576, 0.385, 0.6677, 0.5046, 0.536, 0.598, 0.4828, 0.5219, 0.3762, 0.5142, 0.6466, 0.6545, 0.3435, 0.4697, 0.4984, 0.6126, 0.526, 0.5609, 0.5302, 0.5814, 0.4586, 0.5514, 0.5084], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.3619, 0.4488, 0.3899, 0.4315, 0.5667, 0.5214, 0.4879, 0.6121, 0.5234, 0.3678, 0.4595, 0.4474, 0.4665, 0.5866, 0.5424, 0.4268, 0.3723, 0.5265, 0.4935, 0.4471, 0.446, 0.5428, 0.4506, 0.3081, 0.5022, 0.533, 0.6065, 0.4571, 0.7388, 0.5446, 0.5328, 0.519, 0.4471, 0.4855, 0.4807, 0.3992, 0.3746, 0.4599], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.4501, 0.4503, 0.4344, 0.4316, 0.4037, 0.4061, 0.4451, 0.5214, 0.7956, 0.4558, 0.4793, 0.4078, 0.4736, 0.4421, 0.4422, 0.323, 0.4992, 0.4491, 0.3546, 0.4635, 0.3727, 0.6815, 0.3451, 0.475, 0.4092, 0.3797, 0.3891, 0.3152, 0.3857, 0.418, 0.4672, 0.4515, 0.3563, 0.4614, 0.4362, 0.4186, 0.4823], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.5462, 0.5102, 0.527, 0.4591, 0.4505, 0.4842, 0.4825, 0.4872, 0.4617, 0.5842, 0.4852, 0.5706, 0.439, 0.4431, 0.6861, 0.4804, 0.3779, 0.3848, 0.4409, 0.3855, 0.6, 0.3329, 0.4178, 0.4688, 0.5832, 0.5502, 0.4546, 0.5586, 0.5431, 0.4688, 0.3717, 0.4074, 0.3898, 0.5472, 0.642, 0.4118], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.5196, 0.5927, 0.5835, 0.4772, 0.5287, 0.5576, 0.4037, 0.3877, 0.4473, 0.4926, 0.5591, 0.5314, 0.5112, 0.3456, 0.5198, 0.4388, 0.4443, 0.4927, 0.3637, 0.5224, 0.2929, 0.4343, 0.4897, 0.5061, 0.2847, 0.3192, 0.4827, 0.4747, 0.5044, 0.448, 0.399, 0.4286, 0.4564, 0.5285, 0.4085], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.5868, 0.6132, 0.5659, 0.5465, 0.6145, 0.5909, 0.6122, 0.4915, 0.5001, 0.6456, 0.5428, 0.56, 0.3725, 0.5618, 0.4595, 0.431, 0.8011, 0.4281, 0.6035, 0.385, 0.525, 0.5473, 0.579, 0.3787, 0.3889, 0.5455, 0.6192, 0.5671, 0.5441, 0.4288, 0.516, 0.7143, 0.594, 0.5168], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.5851, 0.5658, 0.6033, 0.5352, 0.454, 0.587, 0.5864, 0.569, 0.7576, 0.6105, 0.5164, 0.3878, 0.5681, 0.4757, 0.491, 0.5655, 0.5456, 0.5158, 0.4162, 0.4815, 0.6268, 0.6669, 0.4079, 0.4833, 0.5977, 0.6385, 0.5022, 0.5169, 0.4936, 0.626, 0.4995, 0.5662, 0.4809], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.6074, 0.538, 0.6943, 0.4657, 0.5132, 0.5146, 0.6983, 0.5964, 0.7479, 0.5475, 0.3378, 0.5369, 0.5384, 0.7017, 0.6688, 0.365, 0.5055, 0.2607, 0.612, 0.5957, 0.5473, 0.3873, 0.4193, 0.4976, 0.5417, 0.7, 0.6508, 0.6087, 0.5258, 0.6212, 0.5375, 0.5456], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.5496, 0.638, 0.4742, 0.5509, 0.5674, 0.5982, 0.5612, 0.6256, 0.4808, 0.3777, 0.5014, 0.5619, 0.6079, 0.6246, 0.3682, 0.4569, 0.4067, 0.622, 0.5478, 0.5303, 0.4015, 0.4345, 0.4648, 0.4978, 0.6751, 0.5957, 0.6039, 0.505, 0.6469, 0.6464, 0.5787], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.6044, 0.528, 0.5221, 0.5813, 0.5947, 0.644, 0.5981, 0.5683, 0.4449, 0.6148, 0.715, 0.4929, 0.5352, 0.537, 0.6108, 0.3891, 0.5401, 0.6021, 0.5466, 0.5019, 0.5739, 0.5972, 0.6229, 0.5792, 0.5596, 0.4723, 0.5775, 0.5238, 0.506, 0.643], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.6142, 0.6109, 0.5856, 0.676, 0.6531, 0.8263, 0.5865, 0.384, 0.5328, 0.6922, 0.6956, 0.6711, 0.452, 0.6405, 0.3821, 0.7218, 0.6249, 0.5063, 0.4249, 0.404, 0.4786, 0.5286, 0.7748, 0.7504, 0.6358, 0.5744, 0.6019, 0.6649, 0.7113], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.5533, 0.5758, 0.4578, 0.5479, 0.4948, 0.5749, 0.3386, 0.5411, 0.5891, 0.3701, 0.6075, 0.3918, 0.7683, 0.3661, 0.524, 0.4338, 0.425, 0.468, 0.3302, 0.4453, 0.4829, 0.5281, 0.5008, 0.4107, 0.4662, 0.5435, 0.5514, 0.6156], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.5899, 0.598, 0.6722, 0.5434, 0.5018, 0.4279, 0.6223, 0.4888, 0.5614, 0.5666, 0.527, 0.5205, 0.5228, 0.4933, 0.7074, 0.4919, 0.4648, 0.3894, 0.5623, 0.6914, 0.4858, 0.5972, 0.5081, 0.6984, 0.572, 0.6422, 0.5516], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.6258, 0.5987, 0.5881, 0.5278, 0.461, 0.5277, 0.464, 0.5192, 0.498, 0.4239, 0.6049, 0.5018, 0.621, 0.5311, 0.5486, 0.498, 0.3775, 0.5419, 0.5323, 0.6214, 0.5905, 0.4633, 0.4955, 0.4959, 0.6231, 0.4983], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.6256, 0.7556, 0.5522, 0.4186, 0.5947, 0.5814, 0.8518, 0.5365, 0.3855, 0.4905, 0.4208, 0.6861, 0.7179, 0.5223, 0.4428, 0.4444, 0.5363, 0.6411, 0.6687, 0.7973, 0.6038, 0.6686, 0.555, 0.5672, 0.6365], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.6771, 0.5919, 0.4503, 0.6646, 0.5301, 0.5878, 0.5865, 0.5543, 0.5859, 0.404, 0.5756, 0.7746, 0.6069, 0.4695, 0.5018, 0.6399, 0.71, 0.6013, 0.601, 0.6366, 0.7182, 0.5923, 0.6183, 0.5148], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.5853, 0.3446, 0.5724, 0.647, 0.8128, 0.5871, 0.4015, 0.5481, 0.3117, 0.7684, 0.678, 0.5721, 0.3659, 0.4017, 0.4616, 0.5388, 0.7935, 0.789, 0.6851, 0.6309, 0.5425, 0.564, 0.6402], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.3742, 0.5693, 0.4946, 0.4969, 0.58, 0.4317, 0.5705, 0.3199, 0.6052, 0.5132, 0.5602, 0.3789, 0.3562, 0.4698, 0.5155, 0.5903, 0.5669, 0.4319, 0.4984, 0.4934, 0.5186, 0.5009], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.4408, 0.3073, 0.3401, 0.3293, 0.3209, 0.4087, 0.3611, 0.3127, 0.3797, 0.5329, 0.5877, 0.4596, 0.4658, 0.4616, 0.3618, 0.3136, 0.3466, 0.3547, 0.4322, 0.4823, 0.3571], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.4624, 0.5151, 0.503, 0.5646, 0.5505, 0.3943, 0.5114, 0.7156, 0.5456, 0.5438, 0.5249, 0.6996, 0.7715, 0.4962, 0.5342, 0.4704, 0.6763, 0.4703, 0.4945, 0.4661], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.5826, 0.55, 0.3815, 0.5976, 0.2688, 0.5717, 0.5223, 0.406, 0.3851, 0.3886, 0.3728, 0.4507, 0.6338, 0.6066, 0.5114, 0.4551, 0.4776, 0.4985, 0.8817], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.5002, 0.3589, 0.3977, 0.3261, 0.6725, 0.7529, 0.4494, 0.3393, 0.3492, 0.4063, 0.5312, 0.6614, 0.7925, 0.699, 0.6749, 0.5202, 0.5274, 0.5845], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.4171, 0.602, 0.3468, 0.5626, 0.5412, 0.5413, 0.4172, 0.3795, 0.4898, 0.5679, 0.6218, 0.5704, 0.484, 0.5112, 0.6802, 0.609, 0.583], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.4147, 0.4491, 0.418, 0.5821, 0.4766, 0.4487, 0.5493, 0.6258, 0.654, 0.3945, 0.4815, 0.3644, 0.5969, 0.3759, 0.4342, 0.3968], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.3502, 0.5232, 0.491, 0.5272, 0.4998, 0.3929, 0.4985, 0.5128, 0.5835, 0.4888, 0.4302, 0.4825, 0.5398, 0.5747, 0.6293], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.3822, 0.4567, 0.3812, 0.371, 0.3433, 0.4358, 0.4531, 0.3052, 0.4522, 0.2878, 0.4371, 0.3571, 0.5288, 0.3564], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.5555, 0.4728, 0.3916, 0.4117, 0.4532, 0.4952, 0.8796, 0.8276, 0.5674, 0.5495, 0.6013, 0.5281, 0.6342], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.5235, 0.4688, 0.4725, 0.6339, 0.7874, 0.5578, 0.6779, 0.6237, 0.8461, 0.5198, 0.5836, 0.5403], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.4169, 0.517, 0.5027, 0.5674, 0.4899, 0.4828, 0.4182, 0.451, 0.5061, 0.5348, 0.4524], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.5399, 0.5807, 0.6117, 0.4452, 0.3747, 0.3622, 0.4397, 0.4482, 0.4897, 0.4139], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.6433, 0.5721, 0.447, 0.3957, 0.3765, 0.445, 0.4153, 0.368, 0.3792], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.7781, 0.4789, 0.4841, 0.3874, 0.6025, 0.5227, 0.5572, 0.3999], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.4953, 0.5493, 0.4754, 0.6789, 0.5465, 0.5737, 0.4927], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.7615, 0.6192, 0.518, 0.6243, 0.5429, 0.6413], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.5669, 0.6872, 0.5934, 0.5732, 0.6699], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.5786, 0.52, 0.5173, 0.5051], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.4947, 0.539, 0.4859], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.6508, 0.5132], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0, 0.5405], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0]]

# Initialize topic_similarity_sum
topic_similarity_sum = [0] * len(topic_similarity_martix)

# Ensure the matrix is symmetric
for i in range(0, 60):
    for j in range(0, i):
        topic_similarity_martix[i][j] = topic_similarity_martix[j][i]

# Calculate the sum of similarities for each topic
for i in range(len(topic_similarity_martix)):
    for j in range(len(topic_similarity_martix[i])):
        topic_similarity_sum[i] += topic_similarity_martix[i][j]

print(topic_similarity_sum)

# Read the Excel file
topic_martix = pd.read_excel(topic_martix_path)
print(topic_martix.iloc[0, 60])

# Initialize the article-topic dictionary
artical_max_topic_dict = {artical: [0, 0] for artical in range(0, 11492)}

# Identify the main topic for each article
for i in range(0, 11400):
    artical_max_topic_dict[i][1] = topic_martix.iloc[i, 1]
    artical_max_topic_dict[i][0] = 0
    for j in range(1, 61):
        if topic_martix.iloc[i, j] > artical_max_topic_dict[i][1]:
            artical_max_topic_dict[i][1] = topic_martix.iloc[i, j]  # max_topic proportion
            artical_max_topic_dict[i][0] = j  # max_topic

print(artical_max_topic_dict)

# Adjust the topic weights based on similarity
for i in range(0, 11400):
    print(i)
    max_topic = artical_max_topic_dict[i][0]
    for j in range(1, 61):
        if j != max_topic:
            topic_martix.iloc[i, j] = (1 - artical_max_topic_dict[i][1]) * topic_similarity_martix[max_topic - 1][j - 1] / (topic_similarity_sum[max_topic - 1] - 1)

# Save the adjusted matrix to an Excel file
topic_martix.to_excel(output_excel_path, index=False)
print("done")