import gensim.downloader as api
import numpy as np
from sklearn.metrics.pairwise import cosine_similarity
import matplotlib.pyplot as plt
import re

# Load the pre-trained Word2Vec model
model = api.load("word2vec-google-news-300")
file_path = r"D:\excel\finance\topic_60_0.8_100_iter=5.txt"

# Read the topic words document
with open(file_path, 'r', encoding='utf-8') as file:
    topic_words_text = file.read()

# Call the previously calculated annual topic weights
year_average_weight_dict = {'00': [0.004228260869565216, 0.13254782608695645, 0.0022815217391304347, 0.012984782608695648, 0.007025000000000001, 0.0017597826086956524, 0.005289130434782609, 0.01569673913043478, 0.001080434782608696, 2.2826086956521737e-05, 0.00021847826086956518, 0.0014271739130434786, 0.008903260869565215, 0.01354021739130435, 0.0297195652173913, 0.1337826086956521, 0.006069565217391301, 0.001282608695652174, 0.005453260869565218, 0.028698913043478255, 0.01054782608695652, 2.2826086956521737e-05, 0.0031206521739130418, 0.012020652173913042, 0.0031108695652173907, 0.003542391304347825, 0.005532608695652174, 2.2826086956521737e-05, 0.017703260869565217, 0.0005369565217391305, 0.0007891304347826089, 0.01373478260869565, 0.03290978260869567, 0.008826086956521737, 2.2826086956521737e-05, 0.012218478260869563, 0.00854021739130435, 0.0009923913043478263, 0.01120978260869565, 0.0017141304347826087, 0.0021130434782608686, 0.0263858695652174, 0.007178260869565217, 0.0008010869565217393, 0.009291304347826088, 2.2826086956521737e-05, 0.10960217391304349, 0.0025576086956521733, 0.0007010869565217392, 0.00030108695652173914, 0.012163043478260865, 0.03641304347826088, 0.003234782608695652, 0.001291304347826087, 0.008128260869565218, 0.0036141304347826085, 0.005729347826086956, 0.018829347826086952, 0.003815217391304347, 0.007080434782608696, 0.0018586956521739128, 0.05515760869565218, 0.0019684782608695647, 0.016166304347826087, 0.00010434782608695651, 0.007310869565217391, 0.007109782608695651, 0.004120652173913042, 0.0017391304347826081, 0.010856521739130433, 0.014544565217391303, 0.003551086956521738, 0.0014347826086956522, 2.2826086956521737e-05, 0.0013423913043478263, 0.01741195652173913, 0.0032641304347826084, 0.005259782608695653, 0.003998913043478261, 0.02363369565217391], '01': [0.004168450704225361, 0.09759732394366209, 0.0037853521126760643, 0.018439436619718298, 0.009836478873239442, 0.00281957746478873, 0.004218873239436623, 0.010973098591549296, 0.0036422535211267635, 1.7464788732394353e-05, 0.005114084507042256, 0.0020867605633802812, 0.003886338028169016, 0.009051408450704238, 0.021445070422535187, 0.07639676056338032, 0.006783802816901413, 0.0005340845070422527, 0.013864366197183078, 0.022084366197183063, 0.00763802816901409, 1.7464788732394353e-05, 0.012046619718309863, 0.004269014084507041, 0.006352535211267614, 0.0037071830985915496, 0.004590000000000003, 5.084507042253522e-05, 0.023409154929577434, 0.0021959154929577437, 0.0005999999999999993, 0.009070000000000009, 0.030461267605633793, 0.006681690140845072, 7.225352112676055e-05, 0.01435971830985916, 0.0048718309859155, 0.0038669014084507097, 0.0032585915492957737, 0.002025492957746477, 0.004544507042253524, 0.02256492957746479, 0.004820140845070428, 0.0007539436619718299, 0.009199014084507058, 0.00029140845070422486, 0.19589971830985947, 0.003166338028169014, 0.0008145070422535204, 0.0003760563380281687, 0.006353802816901417, 0.04435436619718307, 0.0026178873239436607, 0.0017619718309859142, 0.008801267605633808, 0.0025195774647887316, 0.020493661971830984, 0.015207464788732384, 0.003589014084507045, 0.022425070422535203, 0.0032902816901408476, 0.03131450704225349, 0.004641408450704233, 0.012803943661971826, 0.00044309859154929523, 0.004994366197183108, 0.006870985915492967, 0.0018194366197183084, 0.0018856338028168996, 0.01413281690140845, 0.04378887323943659, 0.004110985915492964, 0.002246760563380281, 1.7464788732394353e-05, 0.0012214084507042242, 0.010333661971830993, 0.004653521126760568, 0.0025854929577464776, 0.004971267605633807, 0.016169718309859138], '02': [0.0036543604651162794, 0.09991860465116295, 0.003706395348837213, 0.019832848837209285, 0.0095734011627907, 0.0022986918604651152, 0.00430087209302326, 0.010758575581395348, 0.0031101744186046525, 2.063953488372091e-05, 0.0070667151162790804, 0.0019065406976744178, 0.005011627906976752, 0.009382558139534883, 0.021235029069767427, 0.0833485465116281, 0.007159447674418614, 0.000658575581395348, 0.012612790697674415, 0.022875436046511603, 0.007968168604651158, 2.063953488372091e-05, 0.009757703488372089, 0.004800145348837214, 0.005888226744186054, 0.003650581395348838, 0.004857122093023259, 4.8837209302325526e-05, 0.021849999999999998, 0.002165843023255813, 0.0009979651162790688, 0.008929215116279072, 0.03831104651162787, 0.0068581395348837225, 9.127906976744202e-05, 0.014904360465116282, 0.007670639534883728, 0.0031574127906976736, 0.0033563953488372077, 0.002661482558139534, 0.004746947674418606, 0.021284156976744174, 0.004022819767441865, 0.000667005813953488, 0.008300726744186056, 0.00023575581395348787, 0.2146593023255815, 0.0023654069767441856, 0.0008398255813953479, 0.0002693313953488372, 0.006409738372093032, 0.03489505813953486, 0.0023976744186046486, 0.0025816860465116267, 0.007954505813953492, 0.002793895348837207, 0.013868459302325583, 0.015484883720930213, 0.003501453488372095, 0.018062209302325574, 0.003856104651162792, 0.02814345930232556, 0.004883575581395351, 0.010089244186046517, 0.00044374999999999954, 0.004241569767441869, 0.007417005813953498, 0.0018374999999999984, 0.0020639534883720918, 0.0139203488372093, 0.03460305232558137, 0.004155232558139538, 0.00286845930232558, 2.063953488372091e-05, 0.0018369186046511608, 0.010746366279069773, 0.004633720930232562, 0.0032704941860465134, 0.004155377906976746, 0.014249127906976734], '03': [0.004011031518624645, 0.0883253581661892, 0.0064641833810888324, 0.035957020057306575, 0.010322779369627506, 0.0027743553008595977, 0.004592120343839548, 0.010585386819484243, 0.0034044412607449888, 2.148997134670485e-05, 0.005961318051575932, 0.001981661891117478, 0.004298853868194851, 0.008607020057306595, 0.018714899713467036, 0.07021189111747853, 0.005776074498567344, 0.0007416905444126069, 0.011089255014326643, 0.021069340974212012, 0.007551862464183384, 2.148997134670485e-05, 0.01210630372492836, 0.004404584527220634, 0.005724212034383966, 0.0036525787965616067, 0.005609742120343844, 0.00015945558739255031, 0.022982091690544403, 0.0030051575931232103, 0.0006928366762177647, 0.00894383954154728, 0.04459627507163323, 0.007673065902578803, 0.00014240687679083102, 0.013676934097421201, 0.005361031518624651, 0.003997277936962757, 0.0039829512893982885, 0.0026339541547277926, 0.006410458452722073, 0.019789684813753563, 0.003355444126074497, 0.0006689111747850997, 0.008504727793696282, 0.00014412607449856748, 0.22444641833810913, 0.002487249283667621, 0.0008620343839541538, 0.00022893982808022938, 0.007105730659025793, 0.037950859598853845, 0.0015522922636103148, 0.0028243553008595983, 0.007688968481375365, 0.002399570200573064, 0.011822063037249293, 0.013709025787965613, 0.003808595988538684, 0.01867722063037247, 0.004713467048710609, 0.02086074498567334, 0.004121633237822352, 0.013009025787965613, 0.0003660458452722058, 0.00392120343839542, 0.007988538681948423, 0.002002292263610314, 0.0016962750716332364, 0.013687679083094558, 0.034644985673352426, 0.003560744985673355, 0.0035385386819484247, 2.148997134670485e-05, 0.0011714899713467033, 0.011309312320916904, 0.004526361031518628, 0.004551575931232097, 0.004152005730659024, 0.013036962750716335], '04': [0.0037787172011661827, 0.08201851311953368, 0.0061215743440233335, 0.03928454810495628, 0.010375072886297368, 0.001598979591836734, 0.0047970845481049625, 0.009061078717201165, 0.0033778425655976697, 1.370262390670554e-05, 0.006104081632653064, 0.0024403790087463555, 0.0037240524781341155, 0.010316034985422742, 0.017726822157434388, 0.05446807580174925, 0.005582361516034991, 0.0008623906705539356, 0.009360641399416905, 0.020478134110787163, 0.006674198250728872, 1.370262390670554e-05, 0.00966574344023324, 0.005756268221574354, 0.005865160349854233, 0.0035313411078717223, 0.004984402332361518, 0.00011195335276967945, 0.02414446064139942, 0.0032934402332361504, 0.0010867346938775507, 0.010466763848396501, 0.051829737609329456, 0.008438192419825076, 0.00027069970845481045, 0.017705539358600576, 0.00672769679300292, 0.003883819241982511, 0.004347084548104967, 0.0019527696793002905, 0.008381778425655979, 0.021635131195335264, 0.002934693877551021, 0.0005099125364431483, 0.009318513119533531, 0.00012915451895043745, 0.22311078717201172, 0.00284606413994169, 0.0010679300291545183, 0.00028119533527696784, 0.006899125364431488, 0.039119387755102, 0.0016177842565597647, 0.0026750728862973746, 0.008084256559766766, 0.00249941690962099, 0.014453061224489786, 0.015231924198250715, 0.005547667638483975, 0.018136880466472292, 0.004555685131195341, 0.016600291545189504, 0.0033612244897959186, 0.013080174927113697, 0.00043731778425655943, 0.004712536443148691, 0.007801020408163274, 0.0018820699708454796, 0.0010817784256559762, 0.01409635568513119, 0.03905014577259473, 0.00397594752186589, 0.005825801749271146, 1.370262390670554e-05, 0.001240816326530612, 0.009987900874635563, 0.004640379008746361, 0.004908454810495633, 0.004187609329446068, 0.01095043731778426], '05': [0.0034759740259740265, 0.07123035714285719, 0.005367045454545461, 0.04024220779220777, 0.008812824675324677, 0.0013482142857142855, 0.005187662337662343, 0.0073873376623376655, 0.003171428571428572, 1.298701298701299e-05, 0.007278409090909098, 0.0024865259740259734, 0.004030844155844155, 0.0116150974025974, 0.016800811688311684, 0.046224025974025966, 0.005278896103896101, 0.0008840909090909089, 0.012338474025974025, 0.019554220779220772, 0.006532792207792214, 1.298701298701299e-05, 0.008350162337662332, 0.004812012987012985, 0.006728896103896113, 0.004054545454545454, 0.0044954545454545455, 0.00010730519480519489, 0.02210795454545454, 0.004017532467532472, 0.0012535714285714281, 0.00835081168831169, 0.05656964285714283, 0.007685064935064938, 0.0003629870129870127, 0.02039042207792207, 0.008325487012987014, 0.003765746753246754, 0.003237012987012986, 0.002637987012987012, 0.012075162337662336, 0.022522240259740253, 0.0026517857142857133, 0.00040827922077922053, 0.011720129870129865, 0.00014707792207792214, 0.2242311688311688, 0.0029405844155844145, 0.0011988636363636355, 0.000275487012987013, 0.007106168831168838, 0.041336525974025984, 0.0017410714285714293, 0.0036962662337662344, 0.006897402597402606, 0.0026003246753246753, 0.013812337662337663, 0.016581006493506495, 0.007137012987012993, 0.020565909090909093, 0.005151461038961045, 0.01208522727272727, 0.003764285714285715, 0.015207305194805188, 0.000474350649350649, 0.004081493506493509, 0.0063452922077922155, 0.0014454545454545451, 0.0010501623376623372, 0.014290259740259728, 0.04233863636363637, 0.0036758116883116873, 0.007893668831168836, 1.298701298701299e-05, 0.0015862012987012983, 0.01025405844155845, 0.004371590909090911, 0.004735064935064941, 0.004035064935064937, 0.010139285714285717], '06': [0.003413661202185793, 0.06682021857923498, 0.004604007285974501, 0.047808561020036465, 0.0064005464480874335, 0.0026517304189435337, 0.003636247723132969, 0.006393989071038251, 0.0026023679417122025, 6.010928961748633e-06, 0.00810765027322405, 0.002929508196721312, 0.003965755919854283, 0.013892714025500904, 0.014489981785063747, 0.05047613843351545, 0.004476502732240436, 0.000597814207650273, 0.012566666666666663, 0.022282877959927134, 0.005489617486338799, 6.010928961748633e-06, 0.008336794171220399, 0.005640619307832423, 0.005747176684881603, 0.0038127504553734063, 0.005184153005464482, 0.00011584699453551918, 0.024161930783242257, 0.0034553734061930764, 0.007484335154826964, 0.011333151183970856, 0.08025173041894357, 0.006001821493624775, 0.0002597449908925317, 0.029440801457194892, 0.007816575591985432, 0.004435519125683059, 0.0026218579234972665, 0.002121857923497268, 0.015178142076502733, 0.02205464480874316, 0.0031542805100182145, 0.00033752276867030957, 0.015891803278688523, 0.00013624772313296907, 0.18033970856102016, 0.0029901639344262288, 0.0010351548269581057, 0.0005335154826958103, 0.006248451730418943, 0.031331511839708566, 0.001697085610200363, 0.02120163934426228, 0.0055557377049180335, 0.001599817850637522, 0.010213114754098364, 0.015320218579234973, 0.005279417122040072, 0.02067777777777777, 0.007783970856102011, 0.010128779599271408, 0.005233879781420768, 0.01474954462659381, 0.0007052823315118396, 0.003934790528233155, 0.005305464480874322, 0.000905100182149362, 0.000489799635701275, 0.01292750455373407, 0.031672313296903454, 0.00382295081967213, 0.012728779599271399, 6.010928961748633e-06, 0.001686885245901639, 0.01278214936247723, 0.003169945355191256, 0.005282695810564669, 0.0039205828779599276, 0.009359744990892543], '07': [0.003618122270742357, 0.06624344978165939, 0.004022707423580787, 0.046467685589519636, 0.006396506550218339, 0.0021434497816593882, 0.003645414847161571, 0.007069650655021836, 0.0026829694323144103, 6.113537117903929e-06, 0.004705240174672489, 0.0034368995633187772, 0.00536812227074236, 0.013005895196506558, 0.017894104803493453, 0.05226790393013097, 0.004245633187772924, 0.0004037117903930132, 0.010019432314410482, 0.026770960698689953, 0.005899563318777293, 6.113537117903929e-06, 0.008056113537117906, 0.008544541484716162, 0.0052853711790392995, 0.0038379912663755456, 0.005247598253275109, 0.00010414847161572056, 0.02197336244541485, 0.002607641921397379, 0.0150910480349345, 0.011641921397379911, 0.085982096069869, 0.005483187772925764, 0.0004246724890829694, 0.01847270742358079, 0.007354585152838437, 0.005303275109170306, 0.0033054585152838423, 0.0018318777292576417, 0.017150873362445408, 0.01744541484716158, 0.0027172489082969435, 0.00045960698689956347, 0.01658471615720523, 0.00020174672489082975, 0.19728930131004382, 0.0024759825327510913, 0.001099126637554585, 0.0007242358078602619, 0.006712008733624459, 0.025509170305676867, 0.0023897379912663757, 0.02664323144104804, 0.005921397379912664, 0.0018989082969432308, 0.010054148471615723, 0.014305895196506544, 0.004531222707423583, 0.01624192139737991, 0.008327510917030571, 0.007840829694323143, 0.006391266375545851, 0.010027074235807861, 0.0007746724890829694, 0.00465720524017467, 0.005525109170305677, 0.0007814410480349343, 0.0003379912663755459, 0.014508733624454147, 0.023535589519650648, 0.0036135371179039292, 0.012691266375545851, 6.113537117903929e-06, 0.00255174672489083, 0.009227729257641924, 0.0040620087336244535, 0.0047425764192139735, 0.003949563318777293, 0.008480567685589524], '08': [0.0030016528925619844, 0.049286363636363635, 0.004075413223140495, 0.044400413223140464, 0.009330991735537189, 0.0023811983471074376, 0.0036921487603305773, 0.007303099173553725, 0.0029473140495867764, 9.71074380165289e-06, 0.006785330578512402, 0.0034270661157024796, 0.0037681818181818177, 0.018907231404958674, 0.01730309917355372, 0.043034917355371904, 0.0038489669421487615, 0.000925619834710744, 0.00964545454545455, 0.02299793388429751, 0.006038842975206611, 9.71074380165289e-06, 0.00965805785123967, 0.008545661157024799, 0.006167975206611574, 0.0036615702479338846, 0.004901446280991737, 9.772727272727274e-05, 0.025277685950413225, 0.0036706611570247946, 0.0189836776859504, 0.011421900826446283, 0.07728657024793385, 0.005994628099173552, 0.0019214876033057842, 0.029263016528925625, 0.010533884297520661, 0.00457376033057851, 0.003348553719008264, 0.0019363636363636358, 0.018942148760330582, 0.016428719008264463, 0.004052685950413223, 0.00045702479338842976, 0.015458057851239675, 0.0001915289256198347, 0.16983057851239672, 0.0027954545454545454, 0.000662809917355372, 0.0004805785123966942, 0.0051448347107438015, 0.029942355371900833, 0.0022791322314049574, 0.028145661157024788, 0.006446074380165291, 0.002536570247933884, 0.011758264462809923, 0.0158754132231405, 0.013639256198347103, 0.01423223140495868, 0.008445867768595043, 0.007876652892561986, 0.006864876033057855, 0.01318512396694215, 0.0011727272727272723, 0.004607851239669421, 0.004851652892561984, 0.0009820247933884298, 0.00036404958677685944, 0.015571280991735534, 0.025654132231404954, 0.004401446280991734, 0.019221487603305783, 9.71074380165289e-06, 0.0020987603305785115, 0.012607438016528926, 0.004371280991735537, 0.004228512396694214, 0.00361900826446281, 0.009539669421487606], '09': [0.0021679089026915106, 0.05086645962732921, 0.0033091097308488603, 0.05073788819875783, 0.005788198757763976, 0.002096480331262939, 0.0030267080745341604, 0.002495238095238094, 0.0019710144927536227, 7.246376811594203e-06, 0.004590890269151138, 0.003303726708074534, 0.004289855072463768, 0.016134782608695657, 0.01282712215320911, 0.04403830227743271, 0.004158178053830227, 0.0024467908902691513, 0.011915320910973082, 0.02278033126293996, 0.00551304347826087, 7.246376811594203e-06, 0.009034368530020702, 0.008121946169772264, 0.005465010351966872, 0.004296687370600417, 0.005441407867494823, 5.3416149068322964e-05, 0.020707660455486526, 0.003562732919254657, 0.1361414078674949, 0.011811387163561081, 0.05893498964803309, 0.00668053830227743, 0.0022436853002070394, 0.014664182194616982, 0.0136888198757764, 0.0046459627329192565, 0.0026637681159420285, 0.0017060041407867491, 0.024699378881987564, 0.01875776397515528, 0.0044, 0.0004594202898550724, 0.013887370600414086, 0.0001418219461697723, 0.11688654244306425, 0.0020047619047619046, 0.0006821946169772256, 0.00040931677018633534, 0.0049293995859213255, 0.020139544513457557, 0.0013180124223602478, 0.0223463768115942, 0.004639958592132505, 0.001918219461697722, 0.008474534161490684, 0.017312422360248447, 0.013811801242236021, 0.015669358178053826, 0.008092132505175986, 0.009123809523809532, 0.0058426501035196655, 0.007701035196687372, 0.0011128364389233955, 0.004182194616977226, 0.004074120082815735, 0.00085175983436853, 0.0003677018633540373, 0.014449068322981363, 0.03215051759834366, 0.0037577639751552798, 0.019903933747412006, 7.246376811594203e-06, 0.002400828157349896, 0.01117018633540374, 0.002731262939958591, 0.0037190476190476184, 0.0035047619047619038, 0.007068322981366462], '10': [0.0022038095238095232, 0.03678533333333331, 0.0027599999999999994, 0.04102228571428571, 0.00667161904761905, 0.002275619047619047, 0.0028866666666666663, 0.005320571428571431, 0.0015664761904761904, 8.19047619047619e-06, 0.006404952380952386, 0.00282495238095238, 0.005170285714285715, 0.020796380952380948, 0.01498571428571427, 0.03217066666666664, 0.003235619047619048, 0.00304990476190476, 0.010946666666666665, 0.021611809523809505, 0.00545561904761905, 8.19047619047619e-06, 0.010025142857142856, 0.008866476190476195, 0.005528571428571428, 0.005049142857142858, 0.004986857142857143, 5.085714285714285e-05, 0.020947047619047594, 0.0031685714285714277, 0.1344708571428571, 0.01261047619047619, 0.04482590476190479, 0.007707619047619049, 0.0004971428571428569, 0.030278857142857125, 0.012400380952380956, 0.0051249523809523845, 0.0024203809523809516, 0.0019047619047619041, 0.024135809523809525, 0.02130000000000002, 0.006807619047619053, 0.0004885714285714285, 0.01587809523809523, 0.00013752380952380955, 0.09667504761904765, 0.002628952380952381, 0.0005483809523809522, 0.0004144761904761903, 0.00502742857142857, 0.029822857142857144, 0.0013683809523809514, 0.02212933333333333, 0.005264571428571431, 0.0022432380952380937, 0.00997409523809524, 0.02000914285714285, 0.015380761904761904, 0.014728952380952384, 0.009965523809523811, 0.006731809523809527, 0.0071902857142857185, 0.016485714285714288, 0.001196380952380952, 0.004638285714285715, 0.0038007619047619036, 0.001199428571428572, 0.0003474285714285714, 0.012730285714285715, 0.03630761904761904, 0.004037714285714283, 0.024601904761904773, 8.19047619047619e-06, 0.0020559999999999992, 0.015060952380952383, 0.004834285714285714, 0.0036874285714285702, 0.004298476190476186, 0.0062855238095238086], '11': [0.002304038461538461, 0.037018076923076904, 0.0026374999999999992, 0.03428711538461536, 0.005330000000000007, 0.0020399999999999997, 0.002825192307692306, 0.00770961538461539, 0.0024313461538461533, 5.76923076923077e-06, 0.008653269230769235, 0.0029, 0.005281346153846152, 0.0179876923076923, 0.013380384615384615, 0.034205961538461546, 0.0038721153846153823, 0.0027680769230769217, 0.010907499999999997, 0.020313076923076923, 0.004894423076923076, 5.76923076923077e-06, 0.012380192307692302, 0.010348653846153851, 0.005535961538461537, 0.003826153846153844, 0.005118269230769228, 5.788461538461537e-05, 0.019937307692307685, 0.0031876923076923076, 0.16181634615384605, 0.012494615384615385, 0.03646384615384617, 0.005142307692307692, 0.0019711538461538456, 0.037303076923076925, 0.009301923076923081, 0.005004807692307693, 0.0024130769230769227, 0.002402884615384613, 0.020572884615384625, 0.019179807692307697, 0.004879615384615386, 0.0004609615384615384, 0.015138461538461554, 0.00012480769230769235, 0.09152557692307686, 0.0030023076923076917, 0.0004801923076923077, 0.00043134615384615374, 0.005144423076923076, 0.029324999999999983, 0.0015448076923076917, 0.02522346153846154, 0.005070576923076921, 0.00246326923076923, 0.009342499999999998, 0.017567884615384614, 0.012605000000000007, 0.014711153846153844, 0.0103076923076923, 0.005798653846153843, 0.00777038461538462, 0.016832115384615383, 0.0013573076923076924, 0.003480961538461537, 0.003246346153846154, 0.0011238461538461537, 0.00038749999999999993, 0.01220442307692308, 0.036055384615384614, 0.004701346153846152, 0.02619750000000001, 5.76923076923077e-06, 0.00197, 0.015332307692307694, 0.004650961538461539, 0.0037421153846153837, 0.003895961538461538, 0.005179615384615383], '12': [0.0027177865612648218, 0.03979150197628455, 0.0021081027667984183, 0.029249407114624516, 0.004662252964426878, 0.0012687747035573123, 0.0036389328063241087, 0.008637351778656129, 0.002215019762845849, 6.521739130434784e-06, 0.006768774703557316, 0.0023156126482213432, 0.005179841897233204, 0.020562845849802364, 0.011379051383399208, 0.043370750988142276, 0.003979841897233201, 0.0019420948616600783, 0.011886166007905138, 0.022299407114624487, 0.005556521739130438, 6.521739130434784e-06, 0.00793695652173913, 0.00922332015810277, 0.005638339920948616, 0.004012450592885376, 0.004771739130434782, 5.4347826086956524e-05, 0.01713557312252964, 0.0031158102766798415, 0.1606310276679843, 0.012570355731225297, 0.038862845849802374, 0.006609486166007907, 0.003432411067193676, 0.03515711462450593, 0.009237154150197626, 0.005112450592885378, 0.0017877470355731223, 0.0020438735177865613, 0.018647035573122528, 0.023664031620553357, 0.005752964426877473, 0.00029762845849802376, 0.01440079051383399, 0.00013577075098814232, 0.08953913043478261, 0.0025640316205533596, 0.0005835968379446641, 0.00041067193675889326, 0.005281620553359684, 0.03039525691699603, 0.0012288537549407113, 0.038858102766798436, 0.005161660079051384, 0.004228656126482213, 0.010326482213438735, 0.01574347826086956, 0.014781027667984191, 0.011033596837944666, 0.010219960474308294, 0.007401185770750997, 0.007343083003952574, 0.01810909090909091, 0.0013666007905138336, 0.003147233201581028, 0.002924901185770748, 0.0009845849802371542, 0.0004521739130434782, 0.009890909090909086, 0.025932411067193677, 0.0034873517786561253, 0.024774308300395266, 6.521739130434784e-06, 0.0020162055335968374, 0.013552371541501981, 0.0049241106719367595, 0.002410671936758892, 0.003941304347826088, 0.006716403162055335], '13': [0.0024203921568627445, 0.04068019607843138, 0.0019460784313725485, 0.027156666666666676, 0.004505490196078433, 0.0011711764705882352, 0.0030147058823529415, 0.00897823529411765, 0.0017352941176470586, 4.9019607843137265e-06, 0.005236666666666663, 0.002692549019607843, 0.005097647058823532, 0.025986274509803904, 0.011297254901960783, 0.041614313725490196, 0.0045523529411764675, 0.001978039215686275, 0.011665882352941173, 0.02417705882352942, 0.004349999999999999, 4.9019607843137265e-06, 0.006833725490196082, 0.010865490196078431, 0.004692941176470589, 0.0038596078431372537, 0.005889803921568627, 3.72549019607843e-05, 0.015814509803921573, 0.0029998039215686258, 0.1542060784313726, 0.012270588235294122, 0.03795235294117645, 0.005969019607843144, 0.00448843137254902, 0.03204490196078432, 0.014152745098039208, 0.004442941176470588, 0.002072156862745097, 0.0023921568627450966, 0.015493725490196075, 0.024462745098039206, 0.007101372549019609, 0.00036921568627450976, 0.014111764705882353, 0.00013117647058823534, 0.08556117647058824, 0.0028435294117647057, 0.0006754901960784312, 0.000407254901960784, 0.005257647058823531, 0.028162941176470592, 0.0012084313725490197, 0.04822098039215682, 0.004609215686274508, 0.0027792156862745093, 0.010099019607843146, 0.015168627450980394, 0.02021999999999999, 0.010926470588235296, 0.01059156862745098, 0.006485294117647063, 0.006774509803921568, 0.014568039215686276, 0.0013950980392156856, 0.0031962745098039207, 0.003320392156862745, 0.0008223529411764707, 0.0002658823529411765, 0.011007647058823532, 0.029884901960784305, 0.0035386274509803905, 0.02484156862745097, 4.9019607843137265e-06, 0.002173137254901961, 0.014977254901960788, 0.00504921568627451, 0.0022033333333333315, 0.0034282352941176447, 0.005965490196078432], '14': [0.0028741697416974155, 0.027556826568265677, 0.002740774907749076, 0.02446070110701107, 0.0050134686346863504, 0.0009715867158671586, 0.0032103321033210325, 0.00853690036900369, 0.001914022140221402, 5.904059040590406e-06, 0.005745756457564579, 0.002673247232472324, 0.005619741697416976, 0.03235645756457565, 0.012077675276752763, 0.028551107011070106, 0.0037750922509225083, 0.0018723247232472315, 0.00987675276752767, 0.01961199261992621, 0.006290036900369003, 5.904059040590406e-06, 0.005583394833948341, 0.011378597785977863, 0.005323062730627305, 0.0050409594095940985, 0.0056132841328413305, 6.494464944649447e-05, 0.01959483394833948, 0.002678782287822877, 0.1387051660516606, 0.011910332103321025, 0.03732343173431732, 0.007186900369003694, 0.004357380073800737, 0.04027084870848707, 0.016638376383763833, 0.0043922509225092264, 0.0017682656826568267, 0.001900184501845018, 0.013442066420664207, 0.03720369003690035, 0.008800922509225088, 0.00042527675276752766, 0.01554095940959408, 0.00011291512915129155, 0.07438118081180811, 0.003121586715867158, 0.0005049815498154981, 0.00041143911439114384, 0.004861808118081178, 0.029529889298892987, 0.002149077490774907, 0.05957859778597785, 0.004008302583025829, 0.0032256457564575625, 0.010759225092250921, 0.0181979704797048, 0.025138376383763827, 0.009096494464944647, 0.012546494464944645, 0.004273616236162362, 0.008219372693726934, 0.017661808118081185, 0.0015060885608856082, 0.0027931734317343158, 0.0035306273062730635, 0.0011254612546125458, 0.00043339483394833924, 0.011292619926199265, 0.026259409594095947, 0.0032654981549815497, 0.02508671586715866, 5.904059040590406e-06, 0.0024627306273062735, 0.015832103321033204, 0.004924538745387457, 0.003156826568265681, 0.003510701107011071, 0.005748154981549817], '15': [0.0027134892086330916, 0.031409892086330916, 0.0018429856115107905, 0.021606654676258982, 0.005949100719424464, 0.0009636690647482015, 0.003057913669064747, 0.00889352517985612, 0.002181294964028776, 4.85611510791367e-06, 0.007059172661870507, 0.002340287769784172, 0.005471942446043166, 0.03473974820143886, 0.01529046762589928, 0.027515827338129482, 0.004086870503597123, 0.001530935251798561, 0.009009352517985614, 0.020278956834532375, 0.005407913669064746, 4.85611510791367e-06, 0.006854856115107913, 0.012477517985611513, 0.0048962230215827355, 0.005295323741007196, 0.005087230215827338, 8.021582733812954e-05, 0.020256474820143876, 0.002922841726618705, 0.1263149280575541, 0.010355935251798554, 0.03451456834532374, 0.005751798561151081, 0.005573741007194245, 0.046758093525179865, 0.017255215827338136, 0.003926618705035971, 0.0018235611510791366, 0.0028449640287769784, 0.011729316546762599, 0.03650089928057554, 0.011568705035971214, 0.00026133093525179863, 0.016751618705035977, 4.7482014388489204e-05, 0.07290035971223023, 0.002546762589928057, 0.0005257194244604313, 0.0002127697841726619, 0.004535971223021584, 0.023420683453237414, 0.0014999999999999994, 0.07366546762589933, 0.0034852517985611486, 0.0038532374100719424, 0.011262050359712221, 0.019416546762589932, 0.026140467625899264, 0.009506294964028782, 0.014172482014388487, 0.003198920863309353, 0.008791007194244606, 0.017512769784172662, 0.001386870503597122, 0.0027838129496402875, 0.003282014388489208, 0.0013962230215827335, 0.00041618705035971216, 0.009270503597122304, 0.019395503597122294, 0.003475359712230216, 0.02449208633093525, 4.85611510791367e-06, 0.0023856115107913655, 0.015695683453237422, 0.0045208633093525175, 0.0022672661870503587, 0.00352320143884892, 0.007418345323741007], '16': [0.0025240072202166054, 0.02998971119133574, 0.002529783393501803, 0.02007220216606498, 0.005309386281588448, 0.0009626353790613718, 0.0029427797833935015, 0.007914620938628164, 0.001477797833935018, 5.054151624548736e-06, 0.008026353790613717, 0.002128339350180505, 0.005807942238267151, 0.036005595667870025, 0.014442779783393506, 0.021962996389891687, 0.0033386281588447626, 0.0015202166064981941, 0.007790072202166065, 0.02015487364620939, 0.005816245487364622, 5.054151624548736e-06, 0.008396389891696755, 0.01183465703971119, 0.004979783393501805, 0.005442057761732853, 0.005128880866425995, 5.4332129963898924e-05, 0.016713357400722023, 0.00283537906137184, 0.11593321299638998, 0.009855054151624545, 0.035660288808664245, 0.006625992779783402, 0.005734837545126356, 0.05234386281588449, 0.018173465703971124, 0.004538447653429601, 0.0015180505415162452, 0.0026404332129963894, 0.010393501805054158, 0.03954801444043322, 0.010477978339350175, 0.00028610108303249085, 0.01875270758122743, 4.693140794223826e-05, 0.06792599277978342, 0.0029247292418772552, 0.000529783393501805, 0.00022166064981949467, 0.00454187725631769, 0.02113303249097473, 0.0022700361010830335, 0.08678122743682314, 0.0031126353790613703, 0.0034851985559566766, 0.011873646209386274, 0.017333935018050542, 0.028558303249097472, 0.010102707581227437, 0.014742238267148006, 0.0036157039711191335, 0.008898916967509022, 0.0190101083032491, 0.0015967509025270757, 0.002854151624548736, 0.002838628158844767, 0.0014241877256317699, 0.0003617328519855595, 0.00987635379061372, 0.022611913357400714, 0.004090252707581227, 0.02517671480144405, 5.054151624548736e-06, 0.002878339350180506, 0.014499819494584844, 0.005254693140794223, 0.0015178700361010826, 0.0030557761732851996, 0.005866245487364621], '17': [0.0028622504537205067, 0.02821524500907441, 0.001941379310344827, 0.01916025408348457, 0.005186932849364791, 0.0008568058076225049, 0.0029758620689655157, 0.008536479128856626, 0.0018074410163339385, 5.989110707803991e-06, 0.009881306715063523, 0.0021415607985480947, 0.005453720508166968, 0.04357894736842105, 0.014255535390199636, 0.017211070780399275, 0.003358439201451906, 0.0016593466424682398, 0.00840562613430127, 0.01729909255898366, 0.00553067150635209, 5.989110707803991e-06, 0.007774773139745923, 0.010458076225045378, 0.005184029038112525, 0.0055584392014519065, 0.0053836660617059915, 0.0001415607985480944, 0.0140940108892922, 0.0027925589836660606, 0.10418384754990931, 0.010605081669691468, 0.03310072595281305, 0.007244827586206898, 0.005027767695099821, 0.057176588021778565, 0.021072958257713235, 0.0037424682395644274, 0.0017408348457350273, 0.0021007259528130666, 0.012009981851179675, 0.03024827586206897, 0.01149038112522686, 0.0003544464609800362, 0.017594555353901985, 4.84573502722323e-05, 0.06339292196007264, 0.0031136116152450082, 0.00048457350272232305, 0.00022159709618874772, 0.004189473684210528, 0.0249279491833031, 0.002121234119782214, 0.08890254083484578, 0.0032700544464609807, 0.003648820326678765, 0.01171143375680581, 0.015589655172413792, 0.034268058076225044, 0.010508348457350273, 0.01427059891107078, 0.0026333938294010877, 0.010022867513611623, 0.02277132486388384, 0.0020357531760435564, 0.002516152450090744, 0.003244283121597095, 0.0014704174228675135, 0.00035372050816696914, 0.009810344827586205, 0.027839201451905608, 0.003426678765880218, 0.02669038112522685, 5.989110707803991e-06, 0.0026653357531760432, 0.01741288566243194, 0.007163520871143375, 0.001226497277676951, 0.00304283121597096, 0.00521016333938294], '18': [0.002349393414211437, 0.02168769497400346, 0.002616117850953206, 0.017997746967071064, 0.005061005199306761, 0.0007166377816291161, 0.002819757365684574, 0.007577989601386486, 0.0023549393414211443, 6.932409012131716e-06, 0.00929324090121317, 0.002101213171577123, 0.005490121317157713, 0.047303986135182, 0.014529116117850965, 0.017014558058925468, 0.0033407279029462745, 0.0014826689774696709, 0.00630138648180243, 0.015931369150779896, 0.005299826689774698, 6.932409012131716e-06, 0.007226169844020798, 0.008793240901213176, 0.004994627383015599, 0.006008838821490473, 0.0056188908145580595, 0.00011438474870017335, 0.01682079722703639, 0.0024776429809358733, 0.09192305025996536, 0.010068110918544192, 0.03481282495667243, 0.006313344887348358, 0.005915424610051994, 0.0656511265164644, 0.018227902946273824, 0.0034500866551126505, 0.0012807625649913343, 0.0018811091854419408, 0.010737954939341425, 0.033180242634315425, 0.011415944540727902, 0.00031022530329289434, 0.017762218370883865, 5.251299826689775e-05, 0.05864800693240897, 0.0038396880415944535, 0.0004644714038128251, 0.0001350086655112652, 0.004107972270363953, 0.026003292894280782, 0.00219376083188908, 0.10551923743500866, 0.0035953206239168105, 0.002176949740034661, 0.013303119584055462, 0.01946637781629116, 0.033051819757365666, 0.009215077989601386, 0.014081975736568459, 0.001957192374350086, 0.009405892547660319, 0.02344592720970537, 0.001925649913344887, 0.0024384748700173316, 0.003068630849220102, 0.0017878682842287696, 0.0003495667244367418, 0.009001386481802428, 0.01974956672443674, 0.0036923743500866554, 0.03187261698440206, 6.932409012131716e-06, 0.002961178509532062, 0.019137261698440215, 0.007058925476603123, 0.001115944540727903, 0.0031071057192374346, 0.005415251299826689], '19': [0.0020052083333333324, 0.022622916666666656, 0.0021406249999999984, 0.015559027777777765, 0.005684027777777781, 0.001715451388888889, 0.002355555555555555, 0.008147222222222226, 0.0019046875, 4.513888888888889e-06, 0.00904618055555556, 0.0019623263888888885, 0.00584791666666667, 0.04547812500000001, 0.01532621527777778, 0.016183680555555555, 0.0029770833333333338, 0.0012800347222222217, 0.009672569444444444, 0.016104687500000003, 0.005162847222222223, 4.513888888888889e-06, 0.008692187500000004, 0.009707638888888889, 0.005042013888888889, 0.006770659722222225, 0.005347395833333333, 0.00010017361111111114, 0.013542534722222221, 0.0026201388888888884, 0.08759305555555556, 0.008229166666666662, 0.03177517361111111, 0.006164930555555559, 0.004777256944444444, 0.06240746527777779, 0.017755555555555552, 0.0031821180555555552, 0.0015395833333333336, 0.0019246527777777766, 0.010540277777777779, 0.033759895833333324, 0.010496701388888887, 0.0005241319444444445, 0.02037065972222221, 4.4270833333333337e-05, 0.059224479166666684, 0.003914930555555556, 0.00048402777777777794, 0.0001322916666666667, 0.003597916666666666, 0.028127256944444443, 0.002486631944444444, 0.11805104166666675, 0.0025531249999999985, 0.00254201388888889, 0.012174652777777777, 0.018345486111111114, 0.030897743055555545, 0.011115972222222223, 0.01586388888888889, 0.0021217013888888882, 0.009526909722222223, 0.0251230902777778, 0.001878645833333332, 0.0024503472222222214, 0.0033001736111111096, 0.002038020833333333, 0.00022951388888888886, 0.0094546875, 0.01991736111111111, 0.0037499999999999994, 0.02978645833333334, 4.513888888888889e-06, 0.003525347222222221, 0.017528819444444455, 0.006376562499999999, 0.0011453124999999998, 0.0031463541666666667, 0.004724305555555555], '20': [0.002256792144026185, 0.0200708674304419, 0.0025931260229132575, 0.016468739770867435, 0.0051764320785597385, 0.0019234042553191485, 0.0025541734860883786, 0.008672340425531918, 0.001625531914893616, 6.546644844517185e-06, 0.009620621931260233, 0.0018770867430441898, 0.005150409165302779, 0.04230687397708676, 0.015595908346972177, 0.012235024549918164, 0.002519312602291325, 0.0015967266775777408, 0.00889181669394435, 0.015211620294599021, 0.005280523731587564, 6.546644844517185e-06, 0.00994042553191489, 0.008666939443535185, 0.0047189852700491005, 0.006187234042553187, 0.004608674304418986, 7.10310965630115e-05, 0.015035188216039283, 0.0022468085106382967, 0.07647692307692312, 0.008284451718494273, 0.03273502454991817, 0.0062152209492635025, 0.0026819967266775778, 0.0590900163666121, 0.017260883797054007, 0.003601636661211129, 0.0014996726677577738, 0.0017026186579378055, 0.011331751227495907, 0.030292635024549926, 0.00948150572831424, 0.0005711947626841242, 0.019096399345335507, 4.795417348608837e-05, 0.05776693944353516, 0.0036510638297872332, 0.0005199672667757774, 0.00012340425531914896, 0.0032502454991816675, 0.026170049099836324, 0.0023805237315875603, 0.13838248772504097, 0.0029744680851063812, 0.002274959083469722, 0.012326186579378071, 0.019243044189852704, 0.03160916530278232, 0.011096235679214403, 0.017377086743044168, 0.0020171849427168577, 0.009916530278232409, 0.026308510638297866, 0.0016924713584288045, 0.0019970540098199663, 0.002739279869067103, 0.001630932896890343, 0.0002885433715220949, 0.009152700490998358, 0.027096072013093286, 0.0035461538461538443, 0.032906219312602285, 6.546644844517185e-06, 0.003173486088379704, 0.018551227495908346, 0.005551391162029459, 0.0012702127659574463, 0.0036811783960720127, 0.005496726677577743]}

year_CI_dict = {str(year).zfill(2): 0 for year in range(0, 21)}
similarity = [[0 for _ in range(60)] for _ in range(60)]

# Embed each topic word to get its corresponding vector
def get_word_embedding(word):
    try:
        return model[word]
    except KeyError:
        # If the word is not in the vocabulary of the embedding model, return a zero vector
        print(word)
        return np.zeros(model.vector_size)

# Compute the topic embedding vector
def compute_topic_embedding(topic_words):
    embeddings = [get_word_embedding(word) for word in topic_words]
    embeddings = [emb for emb in embeddings if np.any(emb)]  # Filter out zero vectors
    if len(embeddings) == 0:
        return np.zeros(model.vector_size)
    return np.mean(embeddings, axis=0)

# Calculate cosine similarity between two topics
def cosine_similarity_between_topics(topic1_words, topic2_words):
    # Compute the embedding vector for each topic
    topic1_embedding = compute_topic_embedding(topic1_words)
    topic2_embedding = compute_topic_embedding(topic2_words)

    # Calculate the cosine similarity
    similarity = cosine_similarity([topic1_embedding], [topic2_embedding])[0][0]

    return similarity

# Use regex to split the text into topics
topics = re.split(r"Topic #\d+:\n", topic_words_text.strip())

# Remove the first empty element
topics.pop(0)

word_array = [topic.split() for topic in topics]

print(word_array)

# Calculate the similarity between topics
for i in range(0, 60):
    for j in range(i, 60):
        similarity[i][j] = round(cosine_similarity_between_topics(word_array[i], word_array[j]), 4)
print(similarity)

# Calculate the annual CI metric
for year in year_CI_dict:
    CI = 0
    for i in range(0, 60):
        for j in range(i, 60):
            CI += year_average_weight_dict[year][i] * year_average_weight_dict[year][j] * similarity[i][j]
    year_CI_dict[year] = CI

print(year_CI_dict)

# Plot the annual CI values
x = list(range(0, 21))
plt.plot(x, year_CI_dict.values())
plt.show()